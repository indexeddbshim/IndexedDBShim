/*! indexeddbshim - v6.1.0 - 2020-02-20 */

!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports):"function"==typeof define&&define.amd?define(["exports"],r):r((e=e||self).IDBKeyUtils={})}(this,function(e){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function t(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,r){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var t=[],n=!0,o=!1,a=void 0;try{for(var i,u=e[Symbol.iterator]();!(n=(i=u.next()).done)&&(t.push(i.value),!r||t.length!==r);n=!0);}catch(e){o=!0,a=e}finally{try{n||null==u.return||u.return()}finally{if(o)throw a}}return t}(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function n(e){return function(e){if(Array.isArray(e)){for(var r=0,t=new Array(e.length);r<e.length;r++)t[r]=e[r];return t}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var o={},a={};function i(e,r){return new DOMException.prototype.constructor(r,e||"DOMException")}["DEBUG","cacheDatabaseInstances","autoName","fullIDLSupport","checkOrigin","cursorPreloadPackSize","UnicodeIDStart","UnicodeIDContinue","registerSCA","avoidAutoShim","win","DEFAULT_DB_SIZE","useSQLiteIndexes","addNonIDBGlobals","replaceNonIDBGlobals","escapeDatabaseName","unescapeDatabaseName","databaseCharacterEscapeList","databaseNameLengthLimit","escapeNFDForDatabaseNames","addSQLiteExtension",["memoryDatabase",function(e){if(!/^(?::memory:|file::memory:(\?(?:[\0-"\$-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*)?(#(?:[\0-\t\x0B\f\x0E-\u2027\u202A-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*)?)?$/.test(e))throw new TypeError('`memoryDatabase` must be the empty string, ":memory:", or a "file::memory:[?queryString][#hash] URL".')}],"deleteDatabaseFiles","databaseBasePath","sysDatabaseBasePath","sqlBusyTimeout","sqlTrace","sqlProfile"].forEach(function(e){var r;if(Array.isArray(e)){var n=t(e,2);e=n[0],r=n[1]}Object.defineProperty(a,e,{get:function(){return o[e]},set:function(t){r&&r(t),o[e]=t}})});var u={IndexSizeError:1,HierarchyRequestError:3,WrongDocumentError:4,InvalidCharacterError:5,NoModificationAllowedError:7,NotFoundError:8,NotSupportedError:9,InUseAttributeError:10,InvalidStateError:11,SyntaxError:12,InvalidModificationError:13,NamespaceError:14,InvalidAccessError:15,TypeMismatchError:17,SecurityError:18,NetworkError:19,AbortError:20,URLMismatchError:21,QuotaExceededError:22,TimeoutError:23,InvalidNodeTypeError:24,DataCloneError:25,EncodingError:0,NotReadableError:0,UnknownError:0,ConstraintError:0,DataError:0,TransactionInactiveError:0,ReadOnlyError:0,VersionError:0,OperationError:0,NotAllowedError:0},c={INDEX_SIZE_ERR:1,DOMSTRING_SIZE_ERR:2,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,INVALID_CHARACTER_ERR:5,NO_DATA_ALLOWED_ERR:6,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INUSE_ATTRIBUTE_ERR:10,INVALID_STATE_ERR:11,SYNTAX_ERR:12,INVALID_MODIFICATION_ERR:13,NAMESPACE_ERR:14,INVALID_ACCESS_ERR:15,VALIDATION_ERR:16,TYPE_MISMATCH_ERR:17,SECURITY_ERR:18,NETWORK_ERR:19,ABORT_ERR:20,URL_MISMATCH_ERR:21,QUOTA_EXCEEDED_ERR:22,TIMEOUT_ERR:23,INVALID_NODE_TYPE_ERR:24,DATA_CLONE_ERR:25};var l=function(){function e(e,r){this[Symbol.toStringTag]="DOMException",this._code=r in u?u[r]:c[r]||0,this._name=r||"Error",this._message=void 0===e?"":""+e,Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,writable:!0,value:this._code}),void 0!==r&&Object.defineProperty(this,"name",{configurable:!0,enumerable:!0,writable:!0,value:this._name}),void 0!==e&&Object.defineProperty(this,"message",{configurable:!0,enumerable:!1,writable:!0,value:this._message})}var r=function(){};return r.prototype=Object.create(Error.prototype),["name","message"].forEach(function(t){Object.defineProperty(r.prototype,t,{enumerable:!0,get:function(){if(!(this instanceof e||this instanceof r||this instanceof Error))throw new TypeError("Illegal invocation");return this["_"+t]}})}),Object.defineProperty(r.prototype,"code",{configurable:!0,enumerable:!0,get:function(){throw new TypeError("Illegal invocation")}}),e.prototype=new r,e.prototype[Symbol.toStringTag]="DOMExceptionPrototype",Object.defineProperty(e,"prototype",{writable:!1}),Object.keys(u).forEach(function(r){Object.defineProperty(e.prototype,r,{enumerable:!0,configurable:!1,value:u[r]}),Object.defineProperty(e,r,{enumerable:!0,configurable:!1,value:u[r]})}),Object.keys(c).forEach(function(r){Object.defineProperty(e.prototype,r,{enumerable:!0,configurable:!1,value:c[r]}),Object.defineProperty(e,r,{enumerable:!0,configurable:!1,value:c[r]})}),Object.defineProperty(e.prototype,"constructor",{writable:!0,configurable:!0,enumerable:!1,value:e}),e}();function s(e,r,t){if(a.DEBUG){t&&t.message&&(t=t.message);var n="function"==typeof console.error?"error":"log";console[n](e+": "+r+". "+(t||"")),console.trace&&console.trace()}}var f,y,p=!1;try{f=i("test name","test message"),(y=f)&&"object"===r(y)&&"string"==typeof y.name&&"test name"===f.name&&"test message"===f.message&&(p=!0)}catch(e){}var d=p?function(e,r,t){return s(e,r,t),i(e,r)}:function(e,r,t){return s(e,r,t),function(e,r){return new l(r,e)}(e,r)};function v(e){return function(e){return e.replace(/((?:[\uD800-\uDBFF](?![\uDC00-\uDFFF])))(?!(?:(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]))|(^|(?:[\0-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]))((?:(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]))/g,function(e,r,t,n){return r?"^2"+E(r.charCodeAt().toString(16),4,"0"):(t||"")+"^3"+E(n.charCodeAt().toString(16),4,"0")})}(e.replace(/\^/g,"^^").replace(/\0/g,"^0"))}function F(e){return e&&"object"===r(e)}function D(e){return null===e||void 0===e}function E(e,r,t){return new Array(r-String(e).length+1).join(t)+e}function b(e,t){var n=V(e),o=V(t),i=n>o?1:n===o?0:-1;if(a.DEBUG){var u=K(n),c=K(o);"object"===r(e)&&(e=JSON.stringify(e),u=JSON.stringify(u)),"object"===r(t)&&(t=JSON.stringify(t),c=JSON.stringify(c)),u!==e&&console.warn(e+" was incorrectly encoded as "+u),c!==t&&console.warn(t+" was incorrectly encoded as "+c)}return i}var m={invalid:100,number:200,date:300,string:400,binary:500,array:600},g=Object.keys(m);g.forEach(function(e){m[e]=String.fromCharCode(m[e])});var h=g.reduce(function(e,r){return e[m[r]]=r,e},{}),O=["negativeInfinity","bigNegative","smallNegative","smallPositive","bigPositive","positiveInfinity"],w={invalid:{encode:function(e){return m.invalid+"-"},decode:function(e){}},number:{encode:function(e){var r,t,n,o=e===Number.MIN_VALUE?"0."+"0".repeat(214)+"2":Math.abs(e).toString(32),a=o.indexOf("."),i=(o=-1!==a?o.replace(".",""):o).search(/(?:[\0-\/1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])/);return o=o.slice(i),isFinite(e)?e<0?e>-1?(r=O.indexOf("smallNegative"),t=_(i),n=A(R(o))):(r=O.indexOf("bigNegative"),t=A(_(-1!==a?a:o.length)),n=A(R(o))):e<1?(r=O.indexOf("smallPositive"),t=A(_(i)),n=R(o)):(r=O.indexOf("bigPositive"),t=_(-1!==a?a:o.length),n=R(o)):(t=S(2),n=S(11),r=O.indexOf(e>0?"positiveInfinity":"negativeInfinity")),m.number+"-"+r+t+n},decode:function(e){var r=Number(e.slice(2,3)),t=e.slice(3,5),n=e.slice(5,16);switch(O[r]){case"negativeInfinity":return-1/0;case"positiveInfinity":return 1/0;case"bigPositive":return N(n,t);case"smallPositive":return N(n,t=T(A(t)));case"smallNegative":return t=T(t),-N(n=A(n),t);case"bigNegative":return t=A(t),-N(n=A(n),t);default:throw new Error("Invalid number.")}}},string:{encode:function(e,r){return r&&(e=e.replace(/((?:[\0-\t\x0B\f\x0E-\u2027\u202A-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]))/g,"-$1")+" "),m.string+"-"+e},decode:function(e,r){return e=e.slice(2),r&&(e=e.slice(0,-1).replace(/\x2D((?:[\0-\t\x0B\f\x0E-\u2027\u202A-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]))/g,"$1")),e}},array:{encode:function(e){var r=[],n=!0,o=!1,a=void 0;try{for(var i,u=e.entries()[Symbol.iterator]();!(n=(i=u.next()).done);n=!0){var c=t(i.value,2),l=c[0],s=V(c[1],!0);r[l]=s}}catch(e){o=!0,a=e}finally{try{n||null==u.return||u.return()}finally{if(o)throw a}}return r.push(m.invalid+"-"),m.array+"-"+JSON.stringify(r)},decode:function(e){var r=JSON.parse(e.slice(2));r.pop();for(var t=0;t<r.length;t++){var n=K(r[t],!0);r[t]=n}return r}},date:{encode:function(e){return m.date+"-"+e.toJSON()},decode:function(e){return new Date(e.slice(2))}},binary:{encode:function(e){return m.binary+"-"+(e.byteLength?n(P(e)).map(function(e){return E(e,3,"0")}):"")},decode:function(e){var r=e.slice(2),t=r.length?r.split(",").map(function(e){return parseInt(e)}):[],n=new ArrayBuffer(t.length);return new Uint8Array(n).set(t),n}}};function _(e){return 1===(e=e.toString(32)).length?"0"+e:e}function R(e){return(e+S(11)).slice(0,11)}function A(e){var r="",t=!0,n=!1,o=void 0;try{for(var a,i=e[Symbol.iterator]();!(t=(a=i.next()).done);t=!0){var u=a.value;r+=(31-parseInt(u,32)).toString(32)}}catch(e){n=!0,o=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw o}}return r}function N(e,r){if((r=parseInt(r,32))<0)return I(parseInt(e,32)*Math.pow(32,r-10));if(r<11){var t=e.slice(0,r);t=parseInt(t,32);var n=e.slice(r);return I(t+(n=parseInt(n,32)*Math.pow(32,r-11)))}var o=e+S(r-11);return parseInt(o,32)}function I(e,r){return r=r||16,parseFloat(e.toPrecision(r))}function S(e){return"0".repeat(e)}function T(e){return"-"+e}function C(e){if(Array.isArray(e))return"array";if(F(t=e)&&"function"==typeof t.getDate)return"date";var t;if(function(e){return F(e)&&"number"==typeof e.byteLength&&("function"==typeof e.slice||"function"==typeof e.getFloat64)}(e))return"binary";var n=r(e);return["string","number"].includes(n)?n:"invalid"}function B(e,r){return M(e,r,!1,!0)}function P(e){var r=0,t=0;if(ArrayBuffer.isView(e)){if(void 0===e.buffer)throw new TypeError("Could not copy the bytes held by a buffer source as the buffer was undefined.");r=e.byteOffset,t=e.byteLength}else t=e.byteLength;return new Uint8Array(e.buffer||e,r,t)}function M(e,t,n,o){if((t=t||[]).includes(e))return{type:"array",invalid:!0,message:"An array key cannot be circular"};var a=C(e),i={type:a,value:e};switch(a){case"number":return Number.isNaN(e)?{type:"NaN",invalid:!0}:i;case"string":return i;case"binary":return{type:"binary",value:P(e)};case"array":var u=e.length;t.push(e);for(var c=[],l=0;l<u;l++){if(!n&&!Object.prototype.hasOwnProperty.call(e,l))return{type:a,invalid:!0,message:"Does not have own index property"};try{var s=function(){var r=M(e[l],t,!1,o);if(r.invalid)return n?"continue":{v:{type:a,invalid:!0,message:"Bad array entry value-to-key conversion"}};(!n||!o&&c.every(function(e){return 0!==b(e,r.value)})||o&&c.every(function(e){return 0!==b(e,r)}))&&c.push(o?r:r.value)}();switch(s){case"continue":continue;default:if("object"===r(s))return s.v}}catch(e){if(!n)throw e}}return{type:a,value:c};case"date":return Number.isNaN(e.getTime())?{type:a,invalid:!0,message:"Not a valid date"}:o?{type:a,value:e.getTime()}:{type:a,value:new Date(e.getTime())};case"invalid":default:var f=null===e?"null":r(e);return{type:f,invalid:!0,message:"Not a valid key; type "+f}}}function j(e,r){return M(e,null,!0,r)}function x(e,r,t,n){var o=U(e,r);return o.failure?o:t?j(o.value,n):M(o.value,null,!1,n)}function U(e,r,t,n){if(Array.isArray(r)){var o=[];return r.some(function(r){var t=U(e,r);return!!t.failure||(o.push(t.value),!1)})?{failure:!0}:{value:o}}return""===r?{value:e}:r.split(".").some(function(r,t){if("length"!==r||"string"!=typeof e&&!Array.isArray(e))if(!F(n=e)||"number"!=typeof n.size||"function"!=typeof n.slice||"lastModified"in n){if(!function(e){return F(e)&&"string"==typeof e.name&&"function"==typeof e.slice&&"lastModified"in e}(e))return!F(e)||!Object.prototype.hasOwnProperty.call(e,r)||void 0===(e=e[r]);switch(r){case"name":case"lastModified":e=e[r];break;case"lastModifiedDate":e=new Date(e.lastModified)}}else switch(r){case"size":case"type":e=e[r]}else e=e.length;var n;return!1})?{failure:!0}:{value:e}}function L(e,r,t){var n=void 0===r.lower,o=void 0===r.upper,a=V(e,!0),i=t?r.__lowerCached:V(r.lower,!0),u=t?r.__upperCached:V(r.upper,!0);return void 0!==r.lower&&(r.lowerOpen&&a>i&&(n=!0),!r.lowerOpen&&a>=i&&(n=!0)),void 0!==r.upper&&(r.upperOpen&&a<u&&(o=!0),!r.upperOpen&&a<=u&&(o=!0)),n&&o}function V(e,r){return void 0===e?null:w[C(e)].encode(e,r)}function K(e,r){if("string"==typeof e)return w[h[e.slice(0,1)]].decode(e,r)}var k=9007199254740992;function G(e,r,t,n){e.executeSql('SELECT "currNum" FROM __sys__ WHERE "name" = ?',[v(r.__currentName)],function(e,r){1!==r.rows.length?t(1):t(r.rows.item(0).currNum)},function(e,r){n(d("DataError","Could not get the auto increment value for key",r))})}function H(e,r,t,n,o){var i='UPDATE __sys__ SET "currNum" = ? WHERE "name" = ?',u=[t,v(r.__currentName)];a.DEBUG&&console.log(i,u),e.executeSql(i,u,function(e,r){n(t)},function(e,r){o(d("UnknownError","Could not set the auto increment value for key",r))})}function q(e,r,t,n,o){return H(e,r,t=t===k?t+2:t+1,n,o)}e.assignCurrentNumber=H,e.checkKeyCouldBeInjectedIntoValue=function(e,r){var t=r.split(".");t.pop();var n=!0,o=!1,a=void 0;try{for(var i,u=t[Symbol.iterator]();!(n=(i=u.next()).done);n=!0){var c=i.value;if(!F(e))return!1;if(!Object.prototype.hasOwnProperty.call(e,c))return!0;e=e[c]}}catch(e){o=!0,a=e}finally{try{n||null==u.return||u.return()}finally{if(o)throw a}}return F(e)},e.convertKeyToValue=function e(r){var t=r.type,n=r.value;switch(t){case"number":case"string":return n;case"array":for(var o=[],a=n.length,i=0;i<a;){var u=e(n[i]);o[i]=u,i++}return o;case"date":return new Date(n);case"binary":var c=n.length,l=new ArrayBuffer(c);return new Uint8Array(l,n.byteOffset||0,n.byteLength).set(n),l;case"invalid":default:throw new Error("Bad key")}},e.convertValueToKey=B,e.convertValueToKeyRethrowingAndIfInvalid=function(e,r){var t=B(e,r);if(t.invalid)throw d("DataError",t.message||"Not a valid key; type: "+t.type);return t},e.convertValueToKeyValueDecoded=M,e.convertValueToMultiEntryKey=function(e){return M(e,null,!0,!0)},e.convertValueToMultiEntryKeyDecoded=j,e.decode=K,e.encode=V,e.evaluateKeyPathOnValue=function(e,r,t){return U(e,r)},e.extractKeyFromValueUsingKeyPath=function(e,r,t){return x(e,r,t,!0)},e.extractKeyValueDecodedFromValueUsingKeyPath=x,e.findMultiEntryMatches=function e(r,t){var n=[];if(Array.isArray(r)){var o=!0,a=!1,i=void 0;try{for(var u,c=r[Symbol.iterator]();!(o=(u=c.next()).done);o=!0){var l=u.value;if(Array.isArray(l)){if(t&&t.lower===t.upper)continue;if(1!==l.length){e(l,t).length>0&&n.push(l);continue}l=l[0]}(D(t)||L(l,t,!0))&&n.push(l)}}catch(e){a=!0,i=e}finally{try{o||null==c.return||c.return()}finally{if(a)throw i}}}else(D(t)||L(r,t,!0))&&n.push(r);return n},e.generateKeyForStore=function(e,r,t,n){G(e,r,function(o){o>k?t("failure"):q(e,r,o,function(){t(null,o,o)},n)},n)},e.injectKeyIntoValueUsingKeyPath=function(e,r,t){var n=t.split("."),o=n.pop();n.forEach(function(r){Object.prototype.hasOwnProperty.call(e,r)||(e[r]={}),e=e[r]}),e[o]=r},e.isKeyInRange=L,e.isMultiEntryMatch=function(e,r){return"array"===h[r.slice(0,1)]?r.indexOf(e)>1:r===e},e.possiblyUpdateKeyGenerator=function(e,r,t,n,o){"number"!=typeof t||t<1?n():G(e,r,function(a){var i=Math.floor(Math.min(t,k));i>=a?q(e,r,i,function(){n(a)},o):n()},o)},e.roundTrip=function(e,r){return K(V(e,r),r)},Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=indexeddbshim-Key.min.js.map